# docker-compose.yml - ZeroTier container
# Network ID is injected by Ansible via command override
# DO NOT add the network ID here - keep this file generic/public

services:
  zerotier:
    image: zerotier/zerotier:latest
    container_name: zerotier-one
    restart: unless-stopped
    network_mode: host
    privileged: true
    cap_add:
      - NET_ADMIN
      - SYS_ADMIN
    devices:
      - /dev/net/tun:/dev/net/tun
    volumes:
      - zt-state:/var/lib/zerotier-one
    # Ansible will add/override the command line below
    # Example of what Ansible injects:
    # command: sh -c "zerotier-one -d && sleep 5 && zerotier-cli join YOUR_ID && tail -f /dev/null"

volumes:
  zt-state:
